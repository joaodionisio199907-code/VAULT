<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VAULT | Official Store</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #050505;
            color: white;
            overflow-x: hidden;
        }

        :root {
            --v-green: #76ff03;
            --v-cyan: #00e5ff;
            --v-dark: #0d0d0d;
        }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }

        .glass { background: rgba(0, 0, 0, 0.7); backdrop-filter: blur(15px); border-bottom: 1px solid rgba(255,255,255,0.05); }
        .card-v { background: #0d0d0d; border: 1px solid #1a1a1a; transition: all 0.5s ease; }
        .card-v:hover { border-color: var(--v-green); transform: translateY(-5px); }

        .reveal { opacity: 0; transform: translateY(20px); transition: all 0.6s ease-out; }
        .reveal.active { opacity: 1; transform: translateY(0); }

        .btn-buy { background: var(--v-cyan); color: black; font-weight: 800; border-radius: 12px; transition: 0.3s; cursor: pointer; border: none; }
        .btn-buy:hover { background: white; transform: scale(1.05); }

        #game-modal, #auth-modal { display: none; }
        #game-modal.active, #auth-modal.active { display: flex; }
        .no-scroll { overflow: hidden; }

        .lang-dropdown { display: none; }
        .lang-dropdown.active { display: block; }

        /* ================= LOADER ================= */
        #vault-loader{
            position:fixed;
            inset:0;
            background:radial-gradient(circle at center, #0b0b0b, #000);
            z-index:999999;
            display:flex;
            align-items:center;
            justify-content:center;
        }
        .loader-box{text-align:center}
        .loader-logo{
            width:140px;
            margin:0 auto 30px;
            filter:drop-shadow(0 0 25px var(--v-cyan));
            animation:float 2.5s ease-in-out infinite;
        }
        .loader-bar{
            width:280px;
            height:6px;
            background:rgba(255,255,255,.1);
            border-radius:10px;
            overflow:hidden;
            margin:0 auto 14px;
        }
        .loader-bar span{
            display:block;
            height:100%;
            width:40%;
            background:linear-gradient(90deg,var(--v-green),var(--v-cyan),var(--v-green));
            animation:load 1.2s linear infinite;
        }
        @keyframes load{ from{transform:translateX(-100%)} to{transform:translateX(300%)} }
        @keyframes float{ 0%,100%{transform:translateY(0)} 50%{transform:translateY(-14px)} }
    </style>
</head>
<body>

<div id="vault-loader">
    <div class="loader-box">
        <div class="bg-[#76ff03] p-4 rounded-2xl mb-6 inline-block loader-logo"><i data-lucide="shield" class="text-black w-12 h-12"></i></div>
        <div class="loader-bar"><span></span></div>
        <div class="text-[10px] tracking-[4px] font-black text-cyan-400">VAULT SECURITY SYSTEM</div>
    </div>
</div>

<nav class="fixed top-0 w-full z-[100] glass px-8 py-4">
    <div class="max-w-[1440px] mx-auto flex items-center justify-between">
        <div class="flex items-center gap-10">
            <div class="flex items-center gap-2 cursor-pointer group">
                <div class="bg-[#76ff03] p-1.5 rounded-lg group-hover:rotate-12 transition-transform">
                    <i data-lucide="shield" class="text-black w-6 h-6"></i>
                </div>
                <span class="text-2xl font-black italic tracking-tighter uppercase">VAULT</span>
            </div>
            <div class="hidden lg:flex gap-6 text-[10px] font-bold uppercase tracking-widest text-gray-400">
                <a href="#" class="text-white border-b-2 border-[#76ff03] pb-1" data-key="nav-store">Store</a>
                <a href="#" class="hover:text-white transition" data-key="nav-library">Library</a>
                <a href="#" class="hover:text-white transition" data-key="nav-community">Community</a>
                <a href="#" class="hover:text-white transition" data-key="nav-news">News</a>
                <a href="#" class="text-[#76ff03] animate-pulse" data-key="nav-offers">● Special Offers</a>
            </div>
        </div>
        
        <div class="flex-1 max-w-xl px-10">
            <div class="relative">
                <i data-lucide="search" class="absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"></i>
                <input type="text" data-placeholder="search-placeholder" placeholder="Search games..." class="w-full bg-white/5 border border-white/10 rounded-full py-2.5 pl-12 pr-4 text-xs focus:border-[#76ff03]/50 outline-none">
            </div>
        </div>

        <div class="flex items-center gap-6">
            <div class="relative">
                <button onclick="toggleLang('lang-top')" class="text-xs font-bold text-gray-400 hover:text-white flex items-center gap-1 uppercase">
                    <i data-lucide="languages" class="w-4 h-4"></i> <span class="current-lang">EN</span>
                </button>
                <div id="lang-top" class="lang-dropdown absolute top-10 right-0 bg-[#0d0d0d] border border-white/10 rounded-xl p-2 min-w-[120px] shadow-2xl">
                    <button onclick="changeLanguage('en')" class="w-full text-left px-4 py-2 text-xs hover:bg-white/5 rounded-lg">English</button>
                    <button onclick="changeLanguage('es')" class="w-full text-left px-4 py-2 text-xs hover:bg-white/5 rounded-lg">Español</button>
                </div>
            </div>
            <button onclick="openAuthModal()" id="auth-btn" class="bg-[#00e5ff] text-black text-[10px] font-extrabold px-6 py-2.5 rounded-full uppercase">Sign In</button>
        </div>
    </div>
</nav>

<section class="pt-32 px-8 mb-16">
    <div class="max-w-[1440px] mx-auto relative h-[550px] rounded-[2.5rem] overflow-hidden">
        <img id="hero-img" src="https://images.unsplash.com/photo-1542751371-adc38448a05e?w=1600" class="w-full h-full object-cover">
        <div class="absolute inset-0 bg-gradient-to-r from-black via-black/20 to-transparent"></div>
        <div class="absolute bottom-16 left-16">
            <h1 id="hero-title" class="text-7xl font-black mb-2 uppercase italic leading-none">Neon<br>Overdrive</h1>
            <p id="hero-desc" class="text-cyan-400 font-bold mb-6 tracking-widest uppercase">The Future of RPG is here</p>
            <button class="btn-buy px-12 py-4 text-sm tracking-widest" data-key="btn-buy">GET STARTED</button>
        </div>
    </div>
</section>

<section class="max-w-[1440px] mx-auto px-8 mb-24 reveal">
    <div class="flex justify-between items-center mb-12">
        <h2 class="text-3xl font-black uppercase italic">Featured in VAULT</h2>
        <div class="flex gap-2">
            <button class="p-3 bg-white/5 rounded-full hover:bg-white/10 transition"><i data-lucide="chevron-left"></i></button>
            <button class="p-3 bg-white/5 rounded-full hover:bg-white/10 transition"><i data-lucide="chevron-right"></i></button>
        </div>
    </div>
    
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8" id="vault-grid">
        <div class="col-span-full py-20 text-center text-gray-500 italic">Accessing encrypted database...</div>
    </div>
</section>

<div id="auth-modal" class="fixed inset-0 z-[300] items-center justify-center p-4">
    <div class="absolute inset-0 bg-black/90 backdrop-blur-xl" onclick="closeAuthModal()"></div>
    <div class="bg-[#0d0d0d] w-full max-w-md rounded-[2.5rem] border border-white/10 p-10 relative z-10 animate__animated animate__zoomIn animate__faster">
        <h2 id="auth-title" class="text-4xl font-black uppercase italic mb-2">Welcome</h2>
        <p id="auth-subtitle" class="text-gray-500 text-xs mb-8">Access your VAULT account</p>
        <div class="space-y-4">
            <input type="email" id="auth-email" placeholder="Email" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-4 text-sm outline-none focus:border-cyan-400 transition">
            <input type="password" id="auth-pass" placeholder="Password" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-4 text-sm outline-none focus:border-cyan-400 transition">
            <button onclick="handleAuth()" id="auth-submit-btn" class="w-full bg-cyan-400 text-black font-black py-4 rounded-xl hover:scale-105 transition uppercase text-xs tracking-widest">Sign In</button>
            <p class="text-center text-[10px] text-gray-500">
                <span id="auth-switch-text">New to VAULT?</span> 
                <button onclick="switchAuthMode()" id="auth-switch-btn" class="text-cyan-400 font-bold ml-1">Create Account</button>
            </p>
        </div>
    </div>
</div>

<div id="game-modal" class="fixed inset-0 z-[200] items-center justify-center p-4 sm:p-8">
    <div class="absolute inset-0 bg-black/90 backdrop-blur-xl" onclick="closeModal()"></div>
    <div class="bg-[#0d0d0d] w-full max-w-6xl max-h-[90vh] rounded-[3rem] border border-white/10 overflow-y-auto relative z-10">
        <div class="relative h-[450px]">
            <img id="modal-banner" src="" class="w-full h-full object-cover">
            <div class="absolute inset-0 bg-gradient-to-t from-[#0d0d0d] via-transparent to-transparent"></div>
            <button onclick="closeModal()" class="absolute top-8 right-8 bg-black/50 p-3 rounded-full hover:bg-white/10 transition"><i data-lucide="x"></i></button>
            <div class="absolute bottom-12 left-12 right-12 flex justify-between items-end">
                <div>
                    <span id="modal-cat" class="bg-cyan-500 text-black text-[10px] font-black px-3 py-1 rounded-full uppercase mb-4 inline-block">Category</span>
                    <h2 id="modal-title" class="text-6xl font-black uppercase italic"></h2>
                </div>
                <div class="text-right">
                    <p class="text-3xl font-black text-[#76ff03] mb-4" id="modal-price"></p>
                    <button class="btn-buy px-12 py-4">ADD TO CART</button>
                </div>
            </div>
        </div>
        <div class="p-16">
            <h4 class="text-cyan-400 font-bold uppercase tracking-widest text-xs mb-6">Database Entry / Description</h4>
            <p id="modal-desc" class="text-gray-400 leading-relaxed text-lg max-w-4xl"></p>
        </div>
    </div>
</div>

<script>
    // 1. CONFIGURACIÓN SUPABASE (RELLENA AQUÍ)
    const SUPABASE_URL = 'https://ettjrnpfgbcgwflmgcjv.supabase.co';
    const SUPABASE_KEY = 'sb_publishable_sIyzTHGZX1o4B39cjE7_Aw_WdZ2w5Px';
    const _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    let isLoginMode = true;

    // 2. CARGA DE JUEGOS DINÁMICA
    async function loadGames() {
        try {
            const { data: games, error } = await _supabase
                .from('games')
                .select('*')
                .eq('status', 'verified');

            const grid = document.getElementById('vault-grid');
            if (error) throw error;

            if (games && games.length > 0) {
                grid.innerHTML = '';
                games.forEach(game => {
                    grid.innerHTML += `
                        <div class="card-v rounded-[2rem] overflow-hidden cursor-pointer group" onclick="openGameModal('${game.id}')">
                            <div class="relative h-56 overflow-hidden">
                                <img src="${game.image_url}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700">
                                <div class="absolute top-5 right-5 bg-black/60 backdrop-blur-md px-3 py-1 rounded-full text-[9px] font-black text-cyan-400 uppercase">Vault Exclusive</div>
                            </div>
                            <div class="p-8">
                                <div class="flex justify-between items-start mb-4">
                                    <h3 class="font-black text-xl uppercase italic leading-tight">${game.title}</h3>
                                    <span class="text-[#76ff03] font-black text-xl">${game.price}€</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="text-[10px] text-gray-500 uppercase font-bold tracking-widest">${game.category}</span>
                                    <span class="text-[10px] text-gray-600 ml-auto flex items-center gap-1"><i data-lucide="star" class="w-3 h-3 text-yellow-500 fill-current"></i> 4.9</span>
                                </div>
                            </div>
                        </div>`;
                });
                lucide.createIcons();
            } else {
                grid.innerHTML = '<div class="col-span-full text-center text-gray-600 py-10">Vault is currently empty.</div>';
            }
        } catch (err) {
            console.warn("Supabase no configurado o error de red. Mostrando UI base.");
            document.getElementById('vault-grid').innerHTML = '<div class="col-span-full text-center text-gray-600 py-10">Please connect Supabase to see the games.</div>';
        }
    }

    // 3. MODALES
    async function openGameModal(gameId) {
        const { data: game } = await _supabase.from('games').select('*').eq('id', gameId).single();
        if(game) {
            document.getElementById('modal-title').innerText = game.title;
            document.getElementById('modal-desc').innerText = game.description;
            document.getElementById('modal-price').innerText = game.price + '€';
            document.getElementById('modal-cat').innerText = game.category;
            document.getElementById('modal-banner').src = game.banner_url || game.image_url;
            document.getElementById('game-modal').classList.add('active');
            document.body.classList.add('no-scroll');
        }
    }

    function closeModal() {
        document.getElementById('game-modal').classList.remove('active');
        document.body.classList.remove('no-scroll');
    }

    function openAuthModal() { 
        document.getElementById('auth-modal').classList.add('active'); 
        document.body.classList.add('no-scroll');
    }
    
    function closeAuthModal() { 
        document.getElementById('auth-modal').classList.remove('active'); 
        document.body.classList.remove('no-scroll');
    }

    function switchAuthMode() {
        isLoginMode = !isLoginMode;
        document.getElementById('auth-title').innerText = isLoginMode ? "Welcome" : "Create Account";
        document.getElementById('auth-submit-btn').innerText = isLoginMode ? "Sign In" : "Register";
        document.getElementById('auth-switch-btn').innerText = isLoginMode ? "Create Account" : "Sign In";
    }

    async function handleAuth() {
        const email = document.getElementById('auth-email').value;
        const password = document.getElementById('auth-pass').value;
        if(isLoginMode) {
            const { error } = await _supabase.auth.signInWithPassword({ email, password });
            if(error) alert(error.message); else location.reload();
        } else {
            const { error } = await _supabase.auth.signUp({ email, password });
            if(error) alert(error.message); else alert("Verify your email!");
        }
    }

    // 4. LÓGICA DE IDIOMAS
    const translations = {
        en: { "nav-store": "Store", "nav-library": "Library", "nav-community": "Community", "nav-news": "News", "nav-offers": "● Special Offers", "search-placeholder": "Search games...", "btn-buy": "Buy Now" },
        es: { "nav-store": "Tienda", "nav-library": "Biblioteca", "nav-community": "Comunidad", "nav-news": "Noticias", "nav-offers": "● Ofertas Especiales", "search-placeholder": "Buscar juegos...", "btn-buy": "Comprar Ahora" }
    };

    function changeLanguage(lang) {
        document.querySelectorAll('[data-key]').forEach(el => {
            const key = el.getAttribute('data-key');
            if(translations[lang][key]) el.innerText = translations[lang][key];
        });
        document.querySelectorAll('.current-lang').forEach(el => el.innerText = lang.toUpperCase());
        document.getElementById('lang-top').classList.remove('active');
    }

    function toggleLang(id) { document.getElementById(id).classList.toggle('active'); }

    // 5. REVEAL ANIMATION
    function reveal() {
        const reveals = document.querySelectorAll(".reveal");
        reveals.forEach(el => {
            const windowHeight = window.innerHeight;
            const elementTop = el.getBoundingClientRect().top;
            if (elementTop < windowHeight - 100) el.classList.add("active");
        });
    }
    window.addEventListener("scroll", reveal);

    // 6. LOADER & INIT
    window.addEventListener("load", () => {
        lucide.createIcons();
        loadGames();
        setTimeout(() => {
            const loader = document.getElementById("vault-loader");
            if(loader) {
                loader.style.opacity = "0";
                setTimeout(() => { loader.remove(); reveal(); }, 600);
            }
        }, 2000);
    });
</script>
</body>
</html>
